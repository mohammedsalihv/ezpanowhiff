<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="https://codepen.io/luckyluu/pen/bGbLzXe">
  <link rel="stylesheet" href="https://codepen.io/luckyluu/pen/ZEzxLxR">
  <link rel="stylesheet" href="https://codepen.io/luckyluu/pen/eYOMgXQ">
  <link rel="stylesheet" href="https://codepen.io/luckyluu/pen/jOOVgbE">
  <link rel="stylesheet" href="https://codepen.io/luckyluu/pen/GMpPgN">
  <style>
    .woocommerce-order-overview {
      background: #ffffff;
      list-style: none;
      margin: 2rem 0;
      padding: 0;
      position: relative;
      display: flex;
      align-items: center;
    }

    @media (max-width: 768px) {

      /* Assuming $breakpoint-xs compiles to 768px */
      .woocommerce-order-overview {
        display: block;
      }
    }

    .woocommerce-order-overview:before,
    .woocommerce-order-overview:after {
      background: linear-gradient(transparent 0, transparent 0),
        linear-gradient(135deg, #f8f8f8 33.33%, transparent 33.33%),
        linear-gradient(45deg, #f8f8f8 33.33%, transparent 33.33%);
      content: "";
      display: block;
      position: absolute;
      top: -16px;
      left: 0;
      width: 100%;
      height: 16px;
      background-size: 0 100%, 16px 16px, 16px 16px;
    }

    .woocommerce-order-overview:after {

      bottom: -16px;
      transform: rotate(180deg);
    }

    .woocommerce-order-overview li {
      padding: 1em 1.618em;
      font-size: 0.9em;
      width: 25%;
      text-transform: uppercase;
      border-right: 1px dotted #e3e3e3;
      text-align: center;
    }

    @media (max-width: 768px) {

      /* Assuming $breakpoint-xs compiles to 768px */
      .woocommerce-order-overview li {
        width: auto;
        text-align: left;
        padding: 10px 0;
        margin: 0 15px;
        border-right: none;
        border-bottom: 1px dotted #e3e3e3;
      }

      .woocommerce-order-overview li:last-child {
        border-bottom: none;
      }
    }

    .woocommerce-order-overview li:last-child {
      border-right: none;
    }

    .woocommerce-table--customer-details {
      border: none;
    }

    .woocommerce-table--customer-details tbody th {
      background: #f8f8f8;
      padding-left: 25px;
    }

    @media (max-width: 768px) {

      /* Assuming $breakpoint-xs compiles to 768px */
      .woocommerce-table--customer-details tbody th {
        width: 100%;
        display: block;
        text-align: left;
        padding-top: 5px;
        padding-bottom: 5px;
      }
    }

    .woocommerce-table--customer-details tbody td {
      background: #fdfdfd;
      padding-left: 25px;
      text-align: left !important;
    }

    .shop_table.woocommerce-table--order-details {
      box-shadow: 0 0 5px rgba(57, 180, 74, 0.1);
    }

    .shop_table.woocommerce-table--order-details thead {
      background: #000;
      color: #fff;
    }

    .shop_table.woocommerce-table--order-details thead th {
      border-bottom: none;
      font-weight: normal;
      font-size: .9rem;
    }

    .shop_table.woocommerce-table--order-details thead th.product-name {
      text-align: left;
    }

    .shop_table.woocommerce-table--order-details tbody td {
      border-color: #f0f2f7;
    }

    #thankyouorder {
      background-color: #046963;
      color: #ffffff;
      height: 6vh;
      padding: 6px;
    }

    #bg-orders {
      border-radius: 6px;
      padding: 4px;
    }
  </style>
</head>

<body>
<header class="header-area header-style-1">
    <div id="main-header-higlights" style="background-color:#ffffff; border:1px solid #ffffff; color:black"
        class="header-top header-top-ptb-1 d-none d-lg-block">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-xl-3 col-lg-4">
                    <div style="color: #ffffff;" class="header-info">
                        <ul>
                            <li id="header-li-bg-clr">
                                <a style="color: black; font-weight:900;" href="/userHome">Home</a>
                            </li>
                            <li id="header-li-bg-clr"><a style="color: black; font-weight:900;"
                                    href="/userProductlist">Shop </a>
                            </li>
                            <li id="header-li-bg-clr">
                                <a style="color: black; font-weight:900;" href="/userAccount">Account</a>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="col-xl-6 col-lg-4">
                    <div class="text-center">
                        <div style="color: black;" id="news-flash" class="d-inline-block">
                            <ul>

                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-xl-3 col-lg-4">
                    <div class="header-info header-info-right">
                        <ul>

                            <div class="header-action-right">
                                <div class="header-action-2">
                                    <div class="header-action-icon-2">
                                        <a href="/wishlistPage">
                                            <img class="svgInject" alt="Evara"
                                                src="assets/imgs/theme/icons/icon-heart.svg">
                                            <span style="background-color: #ffffff; color:rgb(255, 255, 255)"
                                                class="pro-count "></span>
                                        </a>
                                    </div>
                                    <div class="header-action-icon-2">
                                        <a class="mini-cart-icon" href="/cart">
                                            <img alt="Evara" src="assets/imgs/theme/icons/icon-cart.svg">
                                            <span style="background-color: #ffffff; color:rgb(255, 255, 255)"
                                                class="pro-count #"></span>
                                        </a>

                                    </div>
                                </div>
                            </div>
                            {{#if this.userLogged}}
                            <div class="d-flex justify-content-right ml-4 mt-2">
                                <button style="background: transparent; border:none" onclick="logoutConfirmation()" type="button">
                                    <i style="color: #000000; font-size:x-large; " class="fa-solid fa-user"></i><i
                                        style="color: #000000; font-size:small"
                                        class="fa-solid fa-right-from-bracket"></i>
                                </button>
                            </div>
                            {{else}}
                            <li>
                                <div style="margin-left: 42%;" class="d-flex justify-content-right "></div>
                                <i class="fi-rs-user"></i><a style="color: #046963;" href="/login">Log In / Sign Up</a>
                    </div>
                    </li>
                    {{/if}}
                    </ul>
                </div>
            </div>
        </div>
    </div>
    </div>
</header>
 <section style="width: 1000px; background-color:#ffffff">
  <div class="container mt-4" style="width: 1500px;">
    <div class="woocommerce-order">
      <p style="width: 1428px;" id="thankyouorder"
         class="woocommerce-notice woocommerce-notice--success woocommerce-thankyou-order-received">
        Your order details
      </p>

      <div class="row" style="width: 120%;">
        <!-- Left Column: Order Summary -->
        <div class="col-md-6">
          <ul class="woocommerce-order-overview woocommerce-thankyou-order-details order_details">
            <li class="woocommerce-order-overview__order order" style="font-weight: 900;">
              Order ID: <br>
              <strong id="bg-orders" class="badge badge-secondary"
                      style="font-weight: 900; font-size: small;">{{orders.nameRandom}}</strong>
            </li>
            <li class="woocommerce-order-overview__date date" style="font-weight: 900;">
              Ordered Date: <br>
              <strong id="bg-orders" style="font-weight: 900;">{{orders.OrderedDate}}</strong>
            </li>
            <li class="woocommerce-order-overview__date date" style="font-weight: 900;">
              Expected arrival : <br>
              <strong id="bg-orders" style="font-weight: 900;">{{orders.ExpectedArrival}}</strong>
            </li>
            <li class="woocommerce-order-overview__total total" style="font-weight: 900;">
              Total: <br>
              <strong><span class="woocommerce-Price-amount amount"><span id="bg-orders"
                                                                        class="bg badge-danger">Rs: {{orders.totalAmount}}</span></span></strong>
            </li>
            <li class="woocommerce-order-overview__payment-method method" style="font-weight: 900;">
              Order status: <br>
              <strong id="bg-orders" class="bg badge-primary">{{orders.orderStatus}}</strong>
            </li>
          </ul>

          <h2 class="woocommerce-order-details__title">Order details</h2>
          <table class="woocommerce-table woocommerce-table--order-details shop_table order_details">
            <thead>
              <tr>
                <th class="woocommerce-table__product-name product-name">Product</th>
                <th class="woocommerce-table__product-table product-total">Total</th>
                <th class="woocommerce-table__product-table product-total">Product status</th>
              </tr>
            </thead>

            <tbody>
              {{#each orderedProducts}}
              <tr class="woocommerce-table__line-item order_item">
                <td class="woocommerce-table__product-name product-name">
                  <img style="height:80px; width:80px;" src="/images/cropped_{{this.img1}}" alt=""><br>
                  <a href="#">{{this.productName}}</a>
                  <strong style="margin-left: 5%;" class="product-quantity"><br>× {{this.quantity}}</strong>
                </td>
                <td class="woocommerce-table__product-total product-total">
                  <span class="woocommerce-Price-amount amount">{{this.salesPrice}}</span>
                </td>
                <td class="woocommerce-table__product-total product-total">
                  <span class="woocommerce-Price-amount amount">{{this.statusProduct}}</span>
                </td>

                <!-- Only show product-level actions if ordersIndexes is false -->
                {{#unless ../ordersIndexes}}
                {{#if ../isDelivered}}
                {{#unless (eq this.statusProduct "returned")}}
                {{#unless (eq this.statusProduct "canceled")}}
                <td class="woocommerce-table__product-total product-total">
                  <form  action="/returnProductOrder" method="POST">
                    <input type="hidden" id="order-id" name="orderId" value="{{../orderID}}">
                    <input type="hidden" id="product-id" name="productId" value="{{this.productId}}">
                    <select style="width: 80%;" id="reason-select" name="returnReason" class="form-select" aria-label="Default select example">
                      <option selected value="Price very high">Price very high</option>
                      <option value="Delivery Time too long">Delivery Time too long</option>
                      <option value="Unsatisfactory Product Information">Unsatisfactory Product Information</option>
                      <option value="Shipping Costs">Shipping Costs</option>
                      <option value="Order Mistakes">Order Mistakes</option>
                      <option value="Change Mind">Change Mind</option>
                      <option value="Other">Other</option>
                    </select>
                    <button style="margin-left: 25%; width: 80%; color:#fff" id="btn-orderReturn" type="submit" >Return</button><br>
                  </form>
                </td>
                {{/unless}}
                {{/unless}}
                {{/if}}
                {{#unless ../isDelivered}}
                {{#unless ../isCanceled}}
                {{#unless (eq this.statusProduct "canceled")}}
                <td class="woocommerce-table__product-total product-total">
                  <span class="woocommerce-Price-amount amount"></span>
                 <button id="btn-ordr-sts-product" style="width: 100%; color:#fff" onclick="productCancel('{{this.productId}}','{{this.orderId}}')">Product cancel</button>

                </td>
                {{/unless}}
                {{/unless}}
                {{/unless}}
                {{/unless}}
              </tr>
              {{/each}}

              <!-- Show the Cancel Order button if ordersIndexes is true and order is not canceled or delivered -->
              {{#if ordersIndexes}}
              {{#unless isCanceled}}
              {{#unless isDelivered}}
              <tr>
                <td colspan="3" class="text-center">
                  <input type="hidden" id="order-Id" value="{{orders._id}}">
                  <button style="width: 20%; color:#fdfdfd" id="btn-orderReturn" type="button" onclick="cancelOrder()">Cancel
                  </button>
                </td>
              </tr>
              {{/unless}}
              {{/unless}}
              {{/if}}
            </tbody>

            <tfoot>
              <tr>
                <th scope="row">Subtotal:</th>
                <td><span class="woocommerce-Price-amount amount">Rs: {{orders.totalAmount}}</span></td>
              </tr>
              <tr>
                <th scope="row">Payment method:</th>
                <td>{{orders.paymentMethod}}</td>
              </tr>
              <tr>
                <th scope="row">Total:</th>
                <td><span class="woocommerce-Price-amount amount">Rs: {{orders.totalAmount}}</span></td>
              </tr>
            </tfoot>
          </table>
        </div>

        <!-- Right Column: Customer Details and Billing Address -->
        <div class="col-md-6 mt-3" style="width: 45%;">
          <section class="woocommerce-customer-details">
            <h2>Customer details</h2>
            <table class="woocommerce-table woocommerce-table--customer-details shop_table customer_details">
              <tbody>
              <tr>
                <th>Phone:</th>
                <td>{{orders.address.phone}}</td>
              </tr>
              </tbody>
            </table>

            <h4 class="woocommerce-column__title mb-3 mt-2">Billing address</h4>
            <address>
              {{orders.address.fullname}}<br>
              {{orders.address.addressLine}}<br>
              {{orders.address.City}}<br>
              {{orders.address.state}}<br>
              {{orders.address.country}}<br>
              {{orders.address.pincode}}
            </address>
            <div class="text-center mt-4">
              {{#if isDelivered}}
              <form id="return-form" action="/returnOrder" method="POST">
                <input type="hidden" id="order-id" name="orderId" value="{{orders._id}}">
                <select id="reason-select" name="returnReason" class="form-select" aria-label="Default select example">
                  <option selected value="Reason">Reason</option>
                  <option value="Price very high">Price very high</option>
                  <option value="Delivery Time too long">Delivery Time too long</option>
                  <option value="Unsatisfactory Product Information">Unsatisfactory Product Information</option>
                  <option value="Shipping Costs">Shipping Costs</option>
                  <option value="Order Mistakes">Order Mistakes</option>
                  <option value="Change Mind">Change Mind</option>
                  <option value="Other">Other</option>
                </select>
                <button style="color: #fff;" id="btn-orderReturn" type="button" onclick="confirmReturn()">Return</button><br>
              </form>
              {{else}}
              {{#unless isCanceled}}
              {{#unless ordersIndexes}}
              <input type="hidden" id="order-Id" value="{{orders._id}}">
              <button style="color: #fff;" id="btn-orderReturn" type="button" onclick="cancelOrder()">Cancel Order</button><br>
              {{/unless}}
              {{/unless}}
              {{/if}}
            </div>

          </section>
        </div>
      </div>
    </div>
  </div>
</section>

          </div>
        </div>
      </div>
    </div>
  </section>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
  <script>
    function logoutConfirmation() {
      Swal.fire({
        title: 'Are you sure?',
        text: "You will be logged out!",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#3085d6',
        cancelButtonColor: '#d33',
        confirmButtonText: 'Yes, log out!'
      }).then((result) => {
        if (result.isConfirmed) {
          Swal.fire(
            'Logged out!',
            'You have been logged out.',
            'success'
          ).then(() => {
            window.location.href = "/userLogout";
          });
        } else {
          window.location.href = "/userHome";
        }
      });
    }
  </script>

  <script>
    function confirmReturn() {
      // Get the selected option value
      const selectedOption = document.getElementById('reason-select').value;

      // Check if any option other than the default is selected
      if (selectedOption !== "Reason") {
        Swal.fire({
          title: "Are you sure?",
          text: "You won't be able to revert this!",
          icon: "warning",
          showCancelButton: true,
          confirmButtonColor: "#3085d6",
          cancelButtonColor: "#d33",
          confirmButtonText: "Yes, Return it!"
        }).then((result) => {
          if (result.isConfirmed) {
            Swal.fire({
              title: "Returned!",
              text: "Your order has been returned",
              icon: "success"
            }).then(() => {
              // Submit the form
              document.getElementById('return-form').submit();
            });
          }
        });
      } else {
        // Show SweetAlert error message if no option is selected
        Swal.fire({
          icon: 'error',
          title: 'Error',
          text: 'Please select a return reason!',
        });
      }
    }
  </script>

  <script>
    function cancelOrder(){
      // Get the order ID
      const orderId = document.getElementById('order-Id').value;
      Swal.fire({
        title: "Are you sure?",
        text: "You won't be able to revert this!",
        icon: "warning",
        showCancelButton: true,
        confirmButtonColor: "#3085d6",
        cancelButtonColor: "#d33",
        confirmButtonText: "Yes, Cancel it!"
      }).then((result) => {
        if (result.isConfirmed) {
          fetch('/orderCancel', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({ orderId: orderId })
          })
            .then(response => response.json())
            .then(data => {
              if (data.error) {
                Swal.fire({
                  icon: 'error',
                  title: 'Error',
                  text: data.error,
                });
              } else {
                Swal.fire({
                  title: "Canceled!",
                  text: "Your order has been canceled.",
                  icon: "success"
                }).then(() => {
                  // Optionally redirect or update the page
                  window.location.reload();
                });
              }
            })
            .catch(error => {
              Swal.fire({
                icon: 'error',
                title: 'Error',
                text: 'Item already delivered.',
              });
              console.error('Error:', error);
            });
        }
      });
    }
  </script>

  <script>
    function productCancel(productId , orderId){
       Swal.fire({
        title: "Are you sure?",
        text: "You won't be able to revert this!",
        icon: "warning",
        showCancelButton: true,
        confirmButtonColor: "#3085d6",
        cancelButtonColor: "#d33",
        confirmButtonText: "Yes, Cancel it!"
      }).then(()=>{

         window.location.href = `/productStatusCancel/${productId}/${orderId}`;

       
      })
     
    }
  </script>